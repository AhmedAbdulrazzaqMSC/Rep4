
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>REMS – Technician Repair Form</title>
  <style>
    body { font-family: Arial, sans-serif; margin: 20px; }
    h2 { margin-bottom: 10px; }
    form {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
      gap: 20px;
    }
    label { font-weight: bold; }
    input, select, textarea {
      width: 100%;
      padding: 8px;
      box-sizing: border-box;
    }
    .full-width { grid-column: 1 / -1; }
    .job-section { border: 1px solid #ccc; padding: 15px; margin-bottom: 10px; }
    button {
      padding: 10px 15px;
      background: #007bff;
      color: #fff;
      border: none;
      cursor: pointer;
      margin-top: 10px;
    }
    button:hover { background: #0056b3; }
  </style>
</head>
<body>
  <div style="background: yellow; padding: 10px; font-weight: bold;">✅ Dynamic Job Form Loaded</div>
  <h2>Technician Repair Form</h2>
  <form id="repairForm">
    <label>CONTAINERNR</label><input type="text" name="containerNr">
    <label>DATUM</label><input type="date" name="datum">
    <label>NAAM</label><input type="text" name="naam">

    <div class="full-width"><h3>Job Tasks</h3></div>
    <div id="jobContainer" class="full-width"></div>
    <button type="button" onclick="addJob()">+ Add Job</button>
    <button type="submit" class="full-width">Submit</button>
  </form>

  <script>
    const jobData = [
      { part: "P123", description: "Compressor Replacement", code: "J001", hours: 2 },
      { part: "P124", description: "Fan Motor Replacement", code: "J002", hours: 1.5 }
    ];

    function addJob() {
      const jobIndex = document.querySelectorAll(".job-section").length + 1;
      const jobDiv = document.createElement("div");
      jobDiv.className = "job-section";
      jobDiv.innerHTML = `
        <h4>Job ${jobIndex}</h4>
        <label>Job Description</label>
        <select onchange="populateJobDetails(this)">
          <option value="">Select Job</option>
          ${jobData.map(j => `<option value="${j.code}">${j.description}</option>`).join('')}
        </select>
        <label>Job Code</label><input type="text" name="jobCode${jobIndex}" readonly>
        <label>Part Number</label><input type="text" name="partNumber${jobIndex}" readonly>
        <label>Part Description</label><input type="text" name="partDesc${jobIndex}" readonly>
        <label>Quantity</label><input type="number" name="quantity${jobIndex}">
        <label>Old Serial Number</label><input type="text" name="oldSerial${jobIndex}">
        <label>New Serial Number</label><input type="text" name="newSerial${jobIndex}">
      `;
      document.getElementById("jobContainer").appendChild(jobDiv);
    }

    function populateJobDetails(select) {
      const selectedJob = jobData.find(j => j.code === select.value);
      if (selectedJob) {
        const section = select.closest(".job-section");
        section.querySelector(`input[name^="jobCode"]`).value = selectedJob.code;
        section.querySelector(`input[name^="partNumber"]`).value = selectedJob.part;
        section.querySelector(`input[name^="partDesc"]`).value = selectedJob.description;
      }
    }

    // Initial Job
    window.onload = () => addJob();
  </script>
</body>
</html>
